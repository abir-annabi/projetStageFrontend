<h2 class="text-center padding-bottom--15">Gestion des Types</h2>

<div class="container form-wrapper">
  <div *ngIf="errorMessage" class="alert alert-danger text-danger">{{ errorMessage }}</div>

  <p-table #dt [value]="types" dataKey="id" editMode="row" [paginator]="true" [rows]="5" [globalFilterFields]="['code', 'libelle']" class="formbg">
    <ng-template pTemplate="caption">
      <div class="flex justify-end">
        <input pInputText type="text" (input)="dt.filterGlobal($any($event.target).value, 'contains')" placeholder="Recherche..." class="form-control" />
      </div>
    </ng-template>

    <ng-template pTemplate="header">
      <tr>
        <th pSortableColumn="code">Code <p-sortIcon field="code"></p-sortIcon></th>
        <th pSortableColumn="libelle">Libellé <p-sortIcon field="libelle"></p-sortIcon></th>
        <th>Actions</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-type let-editing="editing" let-ri="rowIndex">
      <tr [pEditableRow]="type">
        <td>
          <p-cellEditor>
            <ng-template pTemplate="input">
              <input pInputText type="text" [(ngModel)]="type.code" />
            </ng-template>
            <ng-template pTemplate="output">
              {{ type.code }}
            </ng-template>
          </p-cellEditor>
        </td>
        <td>
          <p-cellEditor>
            <ng-template pTemplate="input">
              <input pInputText type="text" [(ngModel)]="type.libelle" />
            </ng-template>
            <ng-template pTemplate="output">
              {{ type.libelle }}
            </ng-template>
          </p-cellEditor>
        </td>
        <td>
          <div class="flex items-center justify-center gap-2">
            <button *ngIf="!editing" pButton pRipple type="button" pInitEditableRow icon="pi pi-pencil" (click)="onRowEditInit(type)" text rounded severity="secondary"></button>
            <button *ngIf="editing" pButton pRipple type="button" pSaveEditableRow icon="pi pi-check" (click)="onRowEditSave(type)" text rounded severity="secondary"></button>
            <button *ngIf="editing" pButton pRipple type="button" pCancelEditableRow icon="pi pi-times" (click)="onRowEditCancel(type, ri)" text rounded severity="secondary"></button>
            <button pButton type="button" icon="pi pi-trash" class="p-button-rounded p-button-danger" (click)="deleteType(type.id)"></button>
          </div>
        </td>
      </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage">
      <tr><td colspan="3">Aucun type trouvé.</td></tr>
    </ng-template>
  </p-table>

  <button class="p-button-success" (click)="router.navigate(['/addType'])">Ajouter un Type</button>
</div>
